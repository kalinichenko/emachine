!function e(t,n,o){function i(r,s){if(!n[r]){if(!t[r]){var c="function"==typeof require&&require;if(!s&&c)return c(r,!0);if(a)return a(r,!0);var l=new Error("Cannot find module '"+r+"'");throw l.code="MODULE_NOT_FOUND",l}var u=n[r]={exports:{}};t[r][0].call(u.exports,function(e){var n=t[r][1][e];return i(n?n:e)},u,u.exports,e,t,n,o)}return n[r].exports}for(var a="function"==typeof require&&require,r=0;r<o.length;r++)i(o[r]);return i}({1:[function(e){"use strict";window.$=window.jQuery=e("jquery"),e("bootstrap");var t=e("rivets"),n=e("howler").Howl;new n({}),document.addEventListener("DOMContentLoaded",function(){var n=e("backbone"),o=e("./app");e("./apps/search"),e("./apps/favorites"),e("./apps/player"),e("./apps/menu"),t.adapters[":"]={observe:function(e,t,n){e.on("change:"+t,n)},unobserve:function(e,t,n){e.off("change:"+t,n)},get:function(e,t){return e.get(t)},set:function(e,t,n){e.set(t,n)}},o.start(),n.history.start()})},{"./app":2,"./apps/favorites":3,"./apps/menu":4,"./apps/player":5,"./apps/search":6,backbone:"backbone",bootstrap:"bootstrap",howler:"howler",jquery:"jquery",rivets:"rivets"}],2:[function(e,t){"use strict";var n,o;o=n=e("jquery");var i=e("backbone");i.$=n;var a=e("backbone.marionette"),r=new a.Application({regions:{menu:"#menu",content:"#content"}});r.navigate=function(e,t){t||(t={}),i.history.navigate(e,t)},r.commands.execute("menu:show"),t.exports=r},{backbone:"backbone","backbone.marionette":"backbone.marionette",jquery:"jquery"}],3:[function(e){"use strict";var t=e("../app"),n=e("backbone.marionette"),o=e("underscore"),i=e("../entities/favorites"),a=e("swipeout"),r=n.AppRouter.extend({appRoutes:{"":"list",favorites:"list"}}),s=n.ItemView.extend({tagName:"tr",template:"#favorite-tr-template",triggers:{"click .del":"favorite:del","click .play":"favorite:play"}}),c=n.CompositeView.extend({template:"#favorite-table-template",childView:s,childViewContainer:"tbody"}),l=n.ItemView.extend({tagName:"li",className:"fixed-height clipping-text",template:o.template("<%= sentence_eng %>"),triggers:{"delete":"favorite:del",click:"favorite:play"}}),u=n.CollectionView.extend({tagName:"ul",className:"list-unstyled list-bordered nav-stick row",childView:l,onShow:function(){new a(this.el)}}),d=n.ItemView.extend({template:"#favorites-empty-template",triggers:{"click .add":"search:show"}}),f={list:function(){t.commands.execute("menu:set-active",".favorites"),i.list().then(function(e){if(e.length>0){var n;n=/iPhone/i.test(navigator.userAgent)?new u({collection:e}):new c({collection:e}),n.on("childview:favorite:del",function(e){i.del(e.model.id)}),n.on("childview:favorite:play",function(e){t.trigger("player:show",e.model.id)}),t.content.show(n)}else{var o=new d;o.on("search:show",function(){t.trigger("search:show")}),t.content.show(o)}})}};t.on("favorite:list",function(){t.navigate("favorites"),f.list()}),t.addInitializer(function(){new r({controller:f})})},{"../app":2,"../entities/favorites":7,"backbone.marionette":"backbone.marionette",swipeout:"swipeout",underscore:"underscore"}],4:[function(e){"use strict";var t=e("../app"),n=e("backbone.marionette"),o=e("jquery"),i=n.ItemView.extend({template:"#menu-template",triggers:{"click .search":"search:show","click .player":"player:show","click .favorites":"favorite:list"},events:{"click .nav a":"onClick"},onClick:function(e){this.$el.find(".active").removeClass("active"),o(e.target).parent().addClass("active"),this.$el.find(".collapse.in").collapse("toggle")},setActive:function(e){this.$el.find(".active").removeClass("active"),this.$el.find(e).parent().addClass("active")}}),a=new i,r={show:function(){a.on("search:show",function(){t.trigger("search:show")}),a.on("player:show",function(){t.trigger("player:show")}),a.on("favorite:list",function(){t.trigger("favorite:list")}),t.menu.show(a)},setActive:function(e){a.setActive(e)}};t.commands.setHandler("menu:show",function(){r.show()}),t.commands.setHandler("menu:set-active",function(e){r.setActive(e)})},{"../app":2,"backbone.marionette":"backbone.marionette",jquery:"jquery"}],5:[function(e){"use strict";var t=e("../app"),n=e("backbone.marionette"),o=e("../entities/favorites"),i=e("../entities/player"),a=e("rivets"),r=n.AppRouter.extend({appRoutes:{"player/:id":"show",player:"show"}}),s=n.ItemView.extend({template:"#player-template",ui:{playPause:".play-pause"},triggers:{"click .paused":"player:play","click .playing":"player:pause"},modelEvents:{"change:statusLoaded":"onLoaded","change:statusLoading":"onLoading"},onShow:function(){this.binding=a.bind(this.$el,{model:this.model})},onDestroy:function(){this.binding.unbind()},onLoaded:function(){this.model.get("statusLoaded")&&this.ui.playPause.button("reset")},onLoading:function(){this.model.get("statusLoading")&&this.ui.playPause.button("loading")}}),c={show:function(e){t.commands.execute("menu:set-active",".player"),o.list().then(function(n){var o=new s({model:i.viewModel()});o.on("player:play",function(){i.play()}),o.on("player:pause",function(){i.pause()}),t.content.show(o);var a;e?a=n.get(e):i.viewModel().has("data")||(a=n.at(0)),a&&i.play(a)})}};t.on("player:show",function(e){t.navigate("player"+(e?"/"+e:"")),c.show(e)}),t.addInitializer(function(){new r({controller:c})})},{"../app":2,"../entities/favorites":7,"../entities/player":8,"backbone.marionette":"backbone.marionette",rivets:"rivets"}],6:[function(e){"use strict";var t=e("../app"),n=e("backbone.marionette"),o=e("backbone"),i=e("rivets"),a=e("../entities/favorites"),r=e("../entities/search"),s=n.AppRouter.extend({appRoutes:{search:"show"}}),c=o.Marionette.LayoutView.extend({className:"finder",template:"#finder-layout-view-template",regions:{filter:".finder-filter",list:".finder-content"}}),l=n.ItemView.extend({className:"sentences-filter",template:"#filter-template",ui:{findButton:".sentences_filter-find"},events:{"click .sentences_filter-find":"onFind","keyup .sentences_filter-criteria":"onEnter"},loaded:function(){this.ui.findButton.button("reset")},onFind:function(){this.ui.findButton.button("loading"),this.trigger("sentences:find")},onEnter:function(e){13===e.keyCode&&this.onFind()},onShow:function(){this.binding=i.bind(this.$el,{model:this.model})},onDestroy:function(){this.binding.unbind()}}),u=n.ItemView.extend({tagName:"tr",template:"#sentence-template",triggers:{"click .sentence-add":"sentence:add"}}),d=n.ItemView.extend({template:"#sentences-empty-template"}),f=n.ItemView.extend({template:"#sentences-error-template",serializeData:function(){return this.model}}),p=n.CompositeView.extend({emptyView:d,childView:u,childViewContainer:"tbody",collectionEvents:{remove:"render"},template:"#sentence-list-template"}),m={show:function(){t.commands.execute("menu:set-active",".search");var e=new c;t.content.show(e);var n=new l({model:r.dataModel()});n.on("sentences:find",function(){r.list({success:function(){n.loaded();var t=r.dataModel().get("sentences"),o=new p({collection:t});o.on("childview:sentence:add",function(e){a.add(e.model.attributes),t.remove(e.model)}),e.list.show(o)},error:function(t,o){n.loaded();var i=new f({model:{status:o.status,statusText:o.statusText}});e.list.show(i)}})}),e.filter.show(n)}};t.on("search:show",function(){t.navigate("search"),m.show()}),t.addInitializer(function(){new s({controller:m})})},{"../app":2,"../entities/favorites":7,"../entities/search":9,backbone:"backbone","backbone.marionette":"backbone.marionette",rivets:"rivets"}],7:[function(e,t){"use strict";var n=e("jquery"),o=e("backbone");o.$=n,o.LocalStorage=e("backbone.localstorage");var i=e("underscore"),a=o.Model.extend({save:function(e,t){t||(t={}),e||(e=i.clone(this.attributes)),delete e.howl,t.data=JSON.stringify(e),o.Model.prototype.save.call(this,e,t)}}),r=o.Collection.extend({model:a,localStorage:new o.LocalStorage("emachine")}),s=function(){var e=new r,t=n.Deferred();return e.fetch({success:t.resolve,error:t.reject}),function(){return t.promise()}}();t.exports={list:function(){return s()},add:function(e){s().then(function(t){t.create(e)})},del:function(e){s().then(function(t){t.get(e).destroy()})}}},{backbone:"backbone","backbone.localstorage":"backbone.localstorage",jquery:"jquery",underscore:"underscore"}],8:[function(e,t){"use strict";function n(e){w.set(e,!0);for(var t in w.attributes)t!==e&&0===t.indexOf("status")&&w.set(t,!1)}function o(){w.set("action","Pause"),n(h.PLAYING),l.howl.play()}function i(){w.set("action","Play"),n(h.PAUSED),l.timeoutId?(clearTimeout(l.timeoutId),delete l.timeoutId):l.howl.pause()}function a(){l.timeoutId?(clearTimeout(l.timeoutId),delete l.timeoutId):l.howl.stop()}function r(){var e=l.collection.indexOf(l),t=e+1<l.collection.length?e+1:0;return l.collection.at(t)}function s(){var e=1.25*l.howl._duration*1e3,t=setTimeout(function(){delete l.timeoutId,p>=2?(l=r(),u=r(),w.set(l.attributes),p=0):p++,o()},e>m?e:m);l.timeoutId=t}function c(e,t){e.howl=new d({urls:["audio/"+e.id+".mp3"],onend:s,onload:function(){t&&t()},onloaderror:function(e){n(h.ERROR),w.set("errorType",e?e.type:"unknown")},onplay:function(){u.howl||c(u)}})}var l,u,d=e("howler").Howl,f=e("backbone"),p=0,m=3e3,h={ERROR:"statusError",LOADING:"statusLoading",LOADED:"statusLoaded",PLAYING:"statusPlaying",PAUSED:"statusPaused"},v=f.Model.extend({defaults:{action:"Pause"}}),w=new v;t.exports={remove:function(){},play:function(e){e?(w.has("data")&&w.get("data").id!==e.id&&a(),w.has("data")&&w.get("data").id===e.id||(l=e,u=r(),w.set({data:l.attributes}),l.howl?o():(n(h.LOADING),c(e,function(){n(h.LOADED),o()})))):o()},pause:function(){i()},viewModel:function(){return w}}},{backbone:"backbone",howler:"howler"}],9:[function(e,t){"use strict";var n=e("jquery"),o=e("backbone");o.$=n;var i=o.Model.extend({defaults:{searchCriteria:""}}),a=o.Model.extend({}),r=o.Collection.extend({model:a,url:"/sentences"}),s=new r,c=new i({sentences:s});t.exports={list:function(e){c.get("searchCriteria")&&(e.data={like:c.get("searchCriteria")}),s.fetch(e)},dataModel:function(){return c}}},{backbone:"backbone",jquery:"jquery"}]},{},[1]);