!function e(t,n,o){function i(r,s){if(!n[r]){if(!t[r]){var c="function"==typeof require&&require;if(!s&&c)return c(r,!0);if(a)return a(r,!0);var l=new Error("Cannot find module '"+r+"'");throw l.code="MODULE_NOT_FOUND",l}var u=n[r]={exports:{}};t[r][0].call(u.exports,function(e){var n=t[r][1][e];return i(n?n:e)},u,u.exports,e,t,n,o)}return n[r].exports}for(var a="function"==typeof require&&require,r=0;r<o.length;r++)i(o[r]);return i}({1:[function(e){"use strict";window.$=window.jQuery=e("jquery"),e("bootstrap");var t=e("rivets");document.addEventListener("DOMContentLoaded",function(){var n=e("backbone"),o=e("./app");e("./apps/search"),e("./apps/favorites"),e("./apps/player"),e("./apps/menu"),t.adapters[":"]={observe:function(e,t,n){e.on("change:"+t,n)},unobserve:function(e,t,n){e.off("change:"+t,n)},get:function(e,t){return e.get(t)},set:function(e,t,n){e.set(t,n)}},o.start(),n.history.start()})},{"./app":2,"./apps/favorites":3,"./apps/menu":4,"./apps/player":5,"./apps/search":6,backbone:"backbone",bootstrap:"bootstrap",jquery:"jquery",rivets:"rivets"}],2:[function(e,t){"use strict";var n,o;o=n=e("jquery");var i=e("backbone");i.$=n;var a=e("backbone.marionette"),r=new a.Application({regions:{menu:"#menu",content:"#content"}});r.navigate=function(e,t){t||(t={}),i.history.navigate(e,t)},r.commands.execute("menu:show"),t.exports=r},{backbone:"backbone","backbone.marionette":"backbone.marionette",jquery:"jquery"}],3:[function(e){"use strict";var t=e("../app"),n=e("backbone.marionette"),o=e("underscore"),i=e("jquery"),a=e("../entities/favorites"),r=n.AppRouter.extend({appRoutes:{"":"list",favorites:"list"}}),s=n.ItemView.extend({tagName:"tr",template:o.template(i("#favorite-template").html()),triggers:{"click .del":"favorite:del","click .play":"favorite:play"}}),c=n.CompositeView.extend({className:"favorites",childView:s,childViewContainer:"tbody",template:o.template(i("#favorites-template").html())}),l=n.ItemView.extend({template:o.template(i("#favorites-empty-template").html()),triggers:{"click .add":"search:show"}}),u={list:function(){t.commands.execute("menu:set-active",".favorites"),a.list().then(function(e){var n;e.length>0?(n=new c({collection:e}),n.on("childview:favorite:del",function(e){a.del(e.model.id)}),n.on("childview:favorite:play",function(e){t.trigger("player:show",e.model.id)})):(n=new l,n.on("search:show",function(){t.trigger("search:show")})),t.content.show(n)})}};t.on("favorite:list",function(){t.navigate("favorites"),u.list()}),t.addInitializer(function(){new r({controller:u})})},{"../app":2,"../entities/favorites":7,"backbone.marionette":"backbone.marionette",jquery:"jquery",underscore:"underscore"}],4:[function(e){"use strict";var t=e("../app"),n=e("backbone.marionette"),o=e("jquery"),i=n.ItemView.extend({template:"#menu-template",triggers:{"click .search":"search:show","click .player":"player:show","click .favorites":"favorite:list"},events:{"click .nav a":"onClick"},onClick:function(e){this.$el.find(".active").removeClass("active"),o(e.target).parent().addClass("active"),this.$el.find(".collapse.in").collapse("toggle")},setActive:function(e){this.$el.find(".active").removeClass("active"),this.$el.find(e).parent().addClass("active")}}),a=new i,r={show:function(){a.on("search:show",function(){t.trigger("search:show")}),a.on("player:show",function(){t.trigger("player:show")}),a.on("favorite:list",function(){t.trigger("favorite:list")}),t.menu.show(a)},setActive:function(e){a.setActive(e)}};t.commands.setHandler("menu:show",function(){r.show()}),t.commands.setHandler("menu:set-active",function(e){r.setActive(e)})},{"../app":2,"backbone.marionette":"backbone.marionette",jquery:"jquery"}],5:[function(e){"use strict";var t=e("../app"),n=e("backbone.marionette"),o=e("underscore"),i=e("jquery"),a=e("../entities/favorites"),r=e("../entities/player"),s=e("rivets"),c=n.AppRouter.extend({appRoutes:{"player/:id":"show",player:"show"}}),l=n.ItemView.extend({template:o.template(i("#player-template").html()),ui:{playPause:".play-pause"},triggers:{"click .play-pause":"player:play-pause"},onShow:function(){this.binding=s.bind(this.$el,{model:this.model})},onDestroy:function(){this.binding.unbind()},loaded:function(){this.ui.playPause.button("reset")},loading:function(){this.ui.playPause.button("loading")}}),u={show:function(e){t.commands.execute("menu:set-active",".player"),a.list().then(function(n){var o=new l({model:r.viewModel()});o.on("player:play-pause",function(){"Pause"===o.model.get("action")?r.pause():r.play()}),t.content.show(o);var i;e?i=n.get(e):r.viewModel().has("id")||(i=n.at(0)),i&&r.play(i,function(){o.loading()},function(){o.loaded()})})}};t.on("player:show",function(e){t.navigate("player"+(e?"/"+e:"")),u.show(e)}),t.addInitializer(function(){new c({controller:u})})},{"../app":2,"../entities/favorites":7,"../entities/player":8,"backbone.marionette":"backbone.marionette",jquery:"jquery",rivets:"rivets",underscore:"underscore"}],6:[function(e){"use strict";var t=e("../app"),n=e("backbone.marionette"),o=e("backbone"),i=e("underscore"),a=e("jquery"),r=e("rivets"),s=e("../entities/favorites"),c=e("../entities/search"),l=n.AppRouter.extend({appRoutes:{search:"show"}}),u=o.Marionette.LayoutView.extend({className:"finder",template:"#finder-layout-view-template",regions:{filter:".finder-filter",list:".finder-content"}}),d=n.ItemView.extend({className:"sentences-filter",template:i.template(a("#filter-template").html()),ui:{findButton:".sentences_filter-find"},events:{"click .sentences_filter-find":"onFind","keyup .sentences_filter-criteria":"onEnter"},loaded:function(){this.ui.findButton.button("reset")},onFind:function(){this.ui.findButton.button("loading"),this.trigger("sentences:find")},onEnter:function(e){13===e.keyCode&&this.onFind()},onShow:function(){this.binding=r.bind(this.$el,{model:this.model})},onDestroy:function(){this.binding.unbind()}}),p=n.ItemView.extend({tagName:"tr",template:i.template(a("#sentence-template").html()),triggers:{"click .sentence-add":"sentence:add"}}),f=n.ItemView.extend({template:i.template(a("#sentences-empty-template").html())}),m=n.ItemView.extend({template:i.template(a("#sentences-error-template").html()),serializeData:function(){return this.model}}),h=n.CompositeView.extend({emptyView:f,childView:p,childViewContainer:"tbody",collectionEvents:{remove:"render"},template:i.template(a("#sentence-list-template").html())}),v={show:function(){t.commands.execute("menu:set-active",".search");var e=new u;t.content.show(e);var n=new d({model:c.dataModel()});n.on("sentences:find",function(){c.list({success:function(){n.loaded();var t=c.dataModel().get("sentences"),o=new h({collection:t});o.on("childview:sentence:add",function(e){s.add(e.model.attributes),t.remove(e.model)}),e.list.show(o)},error:function(t,o){n.loaded();var i=new m({model:{status:o.status,statusText:o.statusText}});e.list.show(i)}})}),e.filter.show(n)}};t.on("search:show",function(){t.navigate("search"),v.show()}),t.addInitializer(function(){new l({controller:v})})},{"../app":2,"../entities/favorites":7,"../entities/search":9,backbone:"backbone","backbone.marionette":"backbone.marionette",jquery:"jquery",rivets:"rivets",underscore:"underscore"}],7:[function(e,t){"use strict";var n=e("jquery"),o=e("backbone");o.$=n,o.LocalStorage=e("backbone.localstorage");var i=e("underscore"),a=o.Model.extend({save:function(e,t){t||(t={}),e||(e=i.clone(this.attributes)),delete e.howl,t.data=JSON.stringify(e),o.Model.prototype.save.call(this,e,t)}}),r=o.Collection.extend({model:a,localStorage:new o.LocalStorage("emachine")}),s=function(){var e=new r,t=n.Deferred();return e.fetch({success:t.resolve,error:t.reject}),function(){return t.promise()}}();t.exports={list:function(){return s()},add:function(e){s().then(function(t){t.create(e)})},del:function(e){s().then(function(t){t.get(e).destroy()})}}},{backbone:"backbone","backbone.localstorage":"backbone.localstorage",jquery:"jquery",underscore:"underscore"}],8:[function(e,t){"use strict";function n(){h.set({action:"Pause"}),c.howl.play()}function o(){h.set({action:"Play"}),c.timeoutId?(clearTimeout(c.timeoutId),delete c.timeoutId):c.howl.pause()}function i(){c.timeoutId?(clearTimeout(c.timeoutId),delete c.timeoutId):c.howl.stop()}function a(){var e=c.collection.indexOf(c),t=e+1<c.collection.length?e+1:0;return c.collection.at(t)}function r(){var e=1.25*c.howl._duration*1e3,t=setTimeout(function(){delete c.timeoutId,p>=2?(c=a(),l=a(),h.set(c.attributes),p=0):p++,n()},e>f?e:f);c.timeoutId=t}function s(e,t){e.howl=new u({urls:["audio/"+e.id+".mp3"],onend:r,onload:function(){t&&t()},onloaderror:function(e){h.set({error:!0,type:e.type})},onplay:function(){l.howl||s(l)}})}var c,l,u=e("howler").Howl,d=e("backbone"),p=0,f=3e3,m=d.Model.extend({defaults:{action:"Pause",sentence_eng:"",sentence_rus:""}}),h=new m;t.exports={remove:function(){},play:function(e,t,o){e?(h.has("id")&&h.get("id")!==e.id&&i(),c=e,l=a(),h.set(c.attributes),c.howl?n():(t&&t(),s(e,function(){o&&o(),n()}))):n()},pause:function(){o()},viewModel:function(){return h}}},{backbone:"backbone",howler:"howler"}],9:[function(e,t){"use strict";var n=e("jquery"),o=e("backbone");o.$=n;var i=o.Model.extend({defaults:{searchCriteria:""}}),a=o.Model.extend({}),r=o.Collection.extend({model:a,url:"/sentences"}),s=new r,c=new i({sentences:s});t.exports={list:function(e){c.get("searchCriteria")&&(e.data={like:c.get("searchCriteria")}),s.fetch(e)},dataModel:function(){return c}}},{backbone:"backbone",jquery:"jquery"}]},{},[1]);