function playNext(){isInterval=!0;var e=1.25*howls[idx]._duration*1e3;setTimeout(function(){repeat>=2?(idx++,repeat=0):repeat++,idx==howls.length&&(idx=0),isInterval&&(play(),isInterval=!1)},e>minInterval?e:minInterval)}function play(){$sentenceEng.innerHTML=howls[idx].sentenceEng,$sentenceRus.innerHTML=howls[idx].sentenceRus,howls[idx].play()}function pause(){isInterval?isInterval=!1:howls[idx].pause()}function onDelete(e){e.target.removeEventListener("click");for(var n=e.target.parentNode.parentNode,t=0;t<howls.length;t++)if(howls[t].id==n.id)return howls.splice(t,1),n.remove(),void 0}function onPlay(){play(),$playCtrlBtn.removeEventListener("click",onPlay),$playCtrlBtn.className="pause-button",$playCtrlBtn.addEventListener("click",onPause),$playListPanel.style.display="none",$playListBtn.style.display="inline-block",$sentencePanel.style.display="block"}function onPause(){pause(),$playCtrlBtn.removeEventListener("click",onPause),$playCtrlBtn.className="play-button",$playCtrlBtn.addEventListener("click",onPlay)}function startPause(){"play-button"===$playCtrlBtn.className?onPlay():onPause()}function onRandom(){load("random")}function onSearch(){var e=document.getElementById("keyword").value;e&&load("sentences?like="+e)}function load(e){howls=[];var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="json",n.onload=function(){for(var e=document.getElementById("play-list-table").children[0];e.firstChild;)e.removeChild(e.firstChild);for(var t=0;t<n.response.length;t++){var l=new Howl({urls:["audio/"+n.response[t].id+".mp3"],onend:playNext});l.id=n.response[t].id,l.sentenceRus=n.response[t].sentence_rus,l.sentenceEng=n.response[t].sentence_eng,howls.push(l);var a=document.createElement("tr");a.id=n.response[t].id;var s=document.createElement("td");s.appendChild(document.createTextNode(n.response[t].sentence_eng)),s.addEventListener("click",startPause),a.appendChild(s);var o=document.createElement("td");a.appendChild(o);var i=document.createElement("a");i.className="delete-item",i.addEventListener("click",onDelete),o.appendChild(i),e.appendChild(a)}$playCtrlBtn.style.display=n.response.length>0?"inline-block":"none"},n.onerror=function(){alert("load error")},n.send()}function onHidePlayList(){var e=document.getElementById("play-list-panel");"none"===window.getComputedStyle(e).display?(e.style.display="block",$playListBtn.style.display="none",onPause(),$sentencePanel.style.display="none"):e.style.display="none"}function onKeyPress(e){if(13==e.keyCode){{document.getElementById("keyword")}return onSearch(),!1}}var playList,howls,repeat=0,idx=0,isInterval=!1,minInterval=3e3,$playCtrlBtn,$playListBtn,$searchBtn,$playListPanel,$sentenceEng,$sentenceRus;window.onload=function(){$playCtrlBtn=document.getElementById("play-ctrl-btn"),$playCtrlBtn.addEventListener("click",onPlay),$playListBtn=document.getElementById("play-list-btn"),$playListBtn.addEventListener("click",onHidePlayList),$searchBtn=document.getElementById("search-btn"),$searchBtn.addEventListener("click",onSearch),$randomBtn=document.getElementById("random-btn"),$randomBtn.addEventListener("click",onRandom),$playListPanel=document.getElementById("play-list-panel"),$sentencePanel=document.getElementById("sentence-panel"),$sentencePanel.addEventListener("click",startPause),$sentenceEng=document.getElementById("sentence-eng"),$sentenceRus=document.getElementById("sentence-rus")};